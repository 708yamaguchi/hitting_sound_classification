<launch>
  <param name="/microphone/name" value="default"/> <!-- default microphone on thinkpad T460s -->
  <param name="/microphone/chunk" value="512"/>
  <param name="/microphone/length" value="512"/>
  <param name="/microphone/rate" value="44100"/>
  <arg name="cutoff_rate" default="8000"/>
  <arg name="hit_volume_threshold" default="0.2"/>
  <arg name="save_image" default="false"/>
  <arg name="target_class" default="table"/>

  <node pkg="hitting_sound_classification" type="listen_microphone.py" name="listen_microphone" output="screen" respawn="true" >
    <param name="cutoff_rate" value="$(arg cutoff_rate)"/>
    <param name="hit_volume_threshold" value="$(arg hit_volume_threshold)"/>
    <param name="time_to_listen" value="0.3"/>
    <param name="save_image" value="$(arg save_image)"/>
    <param name="target_class" value="$(arg target_class)"/>
  </node>

  <!-- sound classification if we do not save sound -->
  <group unless="$(arg save_image)">
      <node pkg="hitting_sound_classification" type="classify_spectrogram_ros.py" name="classify_spectrogram_ros" output="screen">
        <param name="model" value="$(find hitting_sound_classification)/scripts/result/model_best.npz"/>
      </node>
      <node pkg="rqt_gui" type="rqt_gui" name="rqt_gui" args="--perspective-file $(find hitting_sound_classification)/config/spectrogram_classification.perspective"/>
      <node pkg="usb_cam" type="usb_cam_node" name="usb_cam_node" />
  </group>
</launch>
